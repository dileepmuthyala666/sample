/* Database connection*/
package Jdbccurd;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class Dbcon {
	Connection cn=null;
	public static Connection getconn() throws SQLException
	{
		return DriverManager.getConnection("jdbc:mysql://localhost:3306/mysqlclass", "root", "Dileep@7117");
	}
}

/* emp table format*/
package Comjdbc;

public class emp {
	
		private int eid;
		private String ename;
		private int sal;
		private String designation;
		public int geteid() {
			return eid;
		}
		public void seteid(int eid) {
			this.eid = eid;
		}
		public String getename() {
			return ename;
		}
		public void setename(String ename) {
			this.ename = ename;
		}
		public int getsal() {
			return sal;
		}
		public void setsal(int sal) {
			this.sal = sal;
		}
		public String getdesignation() {
			return designation;
		}
		public void setdesignation(String designation) {
			this.designation = designation;
		}
		@Override
		public String toString() {
			return "emp [eid=" + eid + ", ename=" + ename + ",sal="+ sal+", designation=" + designation + "]";
		}
		public emp(int eid, String ename,int sal, String designation) {
			super();
			this.eid = eid;
			this.ename = ename;
			this.sal = sal;
			this.designation=designation;
		}
		

	}


/* crud operations*/
/* insert*/
package Comjdbc;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Scanner;

import Jdbccurd.Dbcon;


public class Jdbcinsert {
	
				public void insert() throws SQLException
				{
				Connection cn=Dbcon.getconn();
				int eid;
				Scanner sc=new Scanner(System.in);
				eid=sc.nextInt();
				String ename;
				ename=sc.next();
				int sal;
				sal=sc.nextInt();
				String designation;
			designation=sc.next();
				emp e=new emp(eid,ename,sal,designation);
				String query="insert into emp values(?,?,?,?)";
			PreparedStatement ps=cn.prepareStatement(query);
			ps.setInt(1, e.geteid());
			ps.setString(2, e.getename());
			ps.setInt(3, e.getsal());
			ps.setString(4, e.getdesignation());
			int r=ps.executeUpdate();
			if(r>0) {
				System.out.println("row inserted");
			}
			else
			{ System.out.println("row fail");
			}
				cn.close();
			}
			
		}
/*insert main*/
   package Comjdbc;
   import java.sql.Connection;
   import java.sql.SQLException;
   import Jdbccurd.Dbcon;
    public class Jdbcinsertmain {
   public static void main(String[] args) throws SQLException {
   Connection cn=Dbcon.getconn();
  Jdbcinsert j=new Jdbcinsert();
   j.insert(); 

			}
	}


/*Update*/
package Comjdbc;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Scanner;

import Jdbccurd.Dbcon;

public class Jdbcupdate {
		public void update() throws SQLException
		{
		Connection cn=Dbcon.getconn();
		int eid;
		Scanner sc=new Scanner(System.in);
		eid=sc.nextInt();
		String ename;
		ename=sc.next();
		int sal;
		sal=sc.nextInt();
		String designation;
	designation=sc.next();
		emp e=new emp(eid,ename,sal,designation);
		String query= "update emp set ename=?, sal=?, designation=? WHERE eid=?";
	PreparedStatement ps=cn.prepareStatement(query);
	
	ps.setString(1, e.getename());
	ps.setInt(2, e.getsal());
	ps.setString(3, e.getdesignation());
	ps.setInt(4, e.geteid());
	int r=ps.executeUpdate();
	if(r>0) {
		System.out.println("row update");
	}
	else
	{ System.out.println("row fail");
	}
		cn.close();
	}
	
}
/*Update main*/
package Comjdbc;
import java.sql.Connection;
import java.sql.SQLException;
import Jdbccurd.Dbcon;

  public class Jdbcupdatemain {
	public static void main(String[] args) throws SQLException {
	Connection cn=Dbcon.getconn();
	Jdbcupdate j=new Jdbcupdate();
	j.update();

	}

}


/*Delete*/
package Comjdbc;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Scanner;

import Jdbccurd.Dbcon;

public class Jdbcdelete {
			public void delete() throws SQLException
			{
			Connection cn=Dbcon.getconn();
			Scanner sc=new Scanner(System.in);
			int eid;
			eid=sc.nextInt();
			String ename;
			ename=sc.next();
			int sal;
			sal=sc.nextInt();
			String designation;
		designation=sc.next();
			emp e=new emp(eid,ename,sal,designation);
			String query= "delete from emp   where eid=?";
		PreparedStatement ps=cn.prepareStatement(query);
		ps.setInt(1, e.geteid());
		int r=ps.executeUpdate();
		if(r>0) 
		{
			System.out.println("row delete");
		}
		else
		{ System.out.println("row fail");
		}
			cn.close();
		}

	}


/*Delete main*/
  package Comjdbc;
  import java.sql.Connection;
  import java.sql.SQLException;
  import Jdbccurd.Dbcon;
  public class Jdbcdeletemain {
   public static void main(String[] args) throws SQLException {
      Connection cn=Dbcon.getconn();
     Jdbcdelete j=new Jdbcdelete();
	j.delete();

	}

}


/*Select*/
package Comjdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.Scanner;

import Jdbccurd.Dbcon;

public class Jdbcselect {
		public void select() throws SQLException
		{
		Connection cn=Dbcon.getconn();
		Scanner sc=new Scanner(System.in);
		int eid;
		eid=sc.nextInt();
		Statement st=cn.createStatement();
		ResultSet rs=st.executeQuery("select * from emp");
     while(rs.next())
     {
    	 System.out.println(rs.getInt(1)+" "+rs.getString(2));
     }
		cn.close();
	}

}

/*Select main*/
package Comjdbc;

import java.sql.Connection;
import java.sql.SQLException;

import Jdbccurd.Dbcon;

public class Jdbcselectmain {
		public static void main(String[] args) throws SQLException {
			Connection cn=Dbcon.getconn();
			Jdbcselect j=new Jdbcselect();
			j.select();

	}

}



